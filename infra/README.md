# ğŸ—ï¸ Infrastructure

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€AWSä¸Šã§ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’Terraformã§ç®¡ç†ã™ã‚‹ãŸã‚ã®ã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
infra/
â”œâ”€â”€ terraform/
â”‚   â”œâ”€â”€ envs/
â”‚   â”‚   â”œâ”€â”€ staging/          # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ main.tf
â”‚   â”‚   â”‚   â”œâ”€â”€ variables.tf
â”‚   â”‚   â”‚   â”œâ”€â”€ backend.tf
â”‚   â”‚   â”‚   â””â”€â”€ terraform.tfvars.example
â”‚   â”‚   â””â”€â”€ prod/             # æœ¬ç•ªç’°å¢ƒï¼ˆä»Šå¾Œè¿½åŠ äºˆå®šï¼‰
â”‚   â””â”€â”€ modules/
â”‚       â””â”€â”€ network/          # VPCãƒ»ã‚µãƒ–ãƒãƒƒãƒˆç­‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚           â”œâ”€â”€ main.tf
â”‚           â”œâ”€â”€ variables.tf
â”‚           â””â”€â”€ outputs.tf
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md
```

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

```bash
# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã®å ´åˆ
cd terraform/envs/staging

# terraform.tfvars.example ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è¨­å®š
cp terraform.tfvars.example terraform.tfvars

# å®Ÿéš›ã®å€¤ã‚’è¨­å®šï¼ˆã‚¨ãƒ‡ã‚£ã‚¿ã§ç·¨é›†ï¼‰
vim terraform.tfvars
```

### 2. Terraformã®åˆæœŸåŒ–

```bash
terraform init
```

### 3. ãƒ—ãƒ©ãƒ³ã®ç¢ºèª

```bash
terraform plan
```

### 4. ã‚¤ãƒ³ãƒ•ãƒ©ã®é©ç”¨

```bash
terraform apply
```

## âš ï¸ é‡è¦ãªæ³¨æ„äº‹é …

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- `terraform.tfvars` ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯æ©Ÿå¯†æƒ…å ±ãŒå«ã¾ã‚Œã‚‹ãŸã‚ã€**çµ¶å¯¾ã«Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ã§ãã ã•ã„**
- `.gitignore` ã§ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯é™¤å¤–ã•ã‚Œã¦ã„ã¾ã™ãŒã€å¿µã®ãŸã‚ç¢ºèªã—ã¦ãã ã•ã„
- AWSèªè¨¼æƒ…å ±ã¯ç’°å¢ƒå¤‰æ•°ã‚„AWS CLIãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„

### çŠ¶æ…‹ç®¡ç†
- ç¾åœ¨ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§çŠ¶æ…‹ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`terraform.tfstate`ï¼‰ã‚’ç®¡ç†ã—ã¦ã„ã¾ã™ãŒã€ãƒãƒ¼ãƒ é–‹ç™ºã®å ´åˆã¯S3ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™
- `backend.tf` ãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®è¨­å®šãŒå¯èƒ½ã§ã™

### ç’°å¢ƒåˆ†é›¢
- `envs/staging/` ã¨ `envs/prod/` ã§ç’°å¢ƒã‚’åˆ†é›¢ã—ã¦ã„ã¾ã™
- å„ç’°å¢ƒã§ç•°ãªã‚‹è¨­å®šå€¤ã‚’ä½¿ç”¨ã§ãã¾ã™

## ğŸ› ï¸ ä»Šå¾Œã®äºˆå®š

- [ ] S3ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ã‚ˆã‚‹çŠ¶æ…‹ç®¡ç†
- [ ] ECS Fargate / App Runner ã®è¨­å®š
- [ ] RDS / Aurora ã®è¨­å®š
- [ ] ALB / CloudFront ã®è¨­å®š
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®è¨­å®š
- [ ] IAMãƒ­ãƒ¼ãƒ«ã®è¨­å®š
- [ ] æœ¬ç•ªç’°å¢ƒã®è¨­å®š

## ğŸ“š å‚è€ƒè³‡æ–™

- [Terraform AWS Provider](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)
- [AWS ECS Best Practices](https://docs.aws.amazon.com/AmazonECS/latest/bestpracticesguide/)
- [Terraform Best Practices](https://www.terraform-best-practices.com/)
